// quite untested, adapted from BigstickCarpet's gist, attempt to make it simpler to usefunction openIndexedDB (fileindex) {  // This works on all devices/browsers, and uses IndexedDBShim as a final fallback   var indexedDB = window.indexedDB || window.mozIndexedDB || window.webkitIndexedDB || window.msIndexedDB || window.shimIndexedDB;  var openDB = indexedDB.open("MyDatabase6", 2);  openDB.onupgradeneeded = function() {    var db = {}    db.result = openDB.result;    db.store = db.result.createObjectStore("MyObjectStore", {keyPath: "id"});    if (fileindex) db.index = db.store.createIndex("question", fileindex, {unique: true});  };  return openDB;}function getStoreIndexedDB (openDB) {  var db = {};  db.result = openDB.result;  db.tx = db.result.transaction("MyObjectStore", "readwrite");  db.store = db.tx.objectStore("MyObjectStore");  db.index = db.store.index("question");  return db;}function saveIndexedDB (file, fileindex) {  var openDB = openIndexedDB(fileindex);  openDB.onsuccess = function() {    var db = getStoreIndexedDB(openDB);    db.store.put(file);  }  return true;}function findIndexedDB (filesearch, callback) {  return loadIndexedDB(null, callback, filesearch);}function loadIndexedDB (filename, callback, filesearch) {  var openDB = openIndexedDB();  openDB.onsuccess = function() {    var db = getStoreIndexedDB(openDB);	alert( db.store.index("question"));    if (filename) {      getData = db.store.get(filename);    } else {      getData = (db.index).get(filesearch);    }    getData.onsuccess = function() {      callback(getData.result);    };    db.tx.oncomplete = function() {      db.result.close();    };  }  return true;}// function getAllQuestions (fileindex) {//   var openDB = openIndexedDB(fileindex);// //   openDB.onsuccess = function() {//     var db = getStoreIndexedDB(openDB);// 		var getAllKeysRequest = db.index.getAllKeys();// 		getAllKeysRequest.onsuccess = function() {// 		  	alert(getAllKeysRequest.result);// 		}//   }//   return true;// }  function getAll(filesearch) {  	var openDB = openIndexedDB(filesearch);  	openDB.onsuccess = function() {    	var db = getStoreIndexedDB(openDB);    	      	let request = db.store.openCursor(null, IDBCursor.NEXT);      	let results = [];      	request.onsuccess = function(e) {        	let cursor = e.target.result;        	if (cursor) {          		console.log("Key:" + cursor.key + " Value:" + cursor.value);          		results.push({ [cursor.key]: cursor.value });          		cursor.continue();        	} else {        		let str="";        		for(i = 0; i < results.length; i++) {//         			str = str + "\n"        			        	//	alert(results);         				let id =Object.getOwnPropertyNames(results[i]);//          				let currObj = results[i];//          				str = str + "\n" + Object.getOwnPropertyNames((results[i])[id]);//         				Object.keys((results[i])[id]).forEach((prop)=> str = str+((results[i])[id]).prop+" ");        				for(var key in (results[i])[id]) {            						var value = ((results[i])[id])[key];    						str = str+value+" ";						}        				str += "\n"  					        		}          		alert(str);        	}      	};      	request.onerror = function(e) {      		alert("ERROR "+e.target.error);      	}  	}  }// function example () {// alert("HEJ");//   var fileindex = "question";//     saveIndexedDB(1, {question: "Is it summer?", answer:"No"}, fileindex);//     saveIndexedDB(2, {question: "Is it winter?", answer:"yes"}, fileindex);// //   loadIndexedDB(1, callbackGetName);//   loadIndexedDB(2, callbackGetName);//   //   findIndexedDB("Is it summer?", callbackGetName);// // }function callbackGetName (filedata) {	let str = filedata.question + "  "+ filedata.answer + "\n";		document.getElementById("p").textContent += str}$(document).ready(function() {	getAll("question");// 	example();	$("#add").click(function() {  		var fileindex = "question";    	saveIndexedDB({id:1, question: "Is it summer?", answer:"No"}, fileindex);    	saveIndexedDB({id:2, question: "Is it winter?", answer:"yes"}, fileindex);	})		$("#show").click(function() { 	  	loadIndexedDB(1, callbackGetName);  		loadIndexedDB(2, callbackGetName);    		findIndexedDB("Is it summer?", callbackGetName);	})	});// // In the following line, you should include the prefixes of implementations you want to test.// window.indexedDB = window.indexedDB || window.mozIndexedDB || window.webkitIndexedDB || window.msIndexedDB;// DON'T use "var indexedDB = ..." if you're not in a function.// Moreover, you may need references to some window.IDB* objects:// window.IDBTransaction = window.IDBTransaction || window.webkitIDBTransaction || window.msIDBTransaction || {READ_WRITE: "readwrite"}; // This line should only be needed if it is needed to support the object's constants for older browsers// window.IDBKeyRange = window.IDBKeyRange || window.webkitIDBKeyRange || window.msIDBKeyRange;// (Mozilla has never prefixed these objects, so we don't need window.mozIDB*)// // let request = window.indexedDB.open("MyTestDatabase", 3);// let db, tx, store, index;// // below will happen first time we start up. Once this is done, onsuccess is called// request.onupgradeneeded = function(e) {// 	let db = request.result;// 	let store = db.createObjectStore("NameOfStore", {keyPath: "qID"});// 	// 	set up index to be able to query through// 	let index = store.createIndex("birthday", "birthday", {unique: true});// }// // request.onerror = function(e) {// 	alert("An error occurred: " + e.target.errorcode);// };// // request.onsuccess = function(e) {// 	db = request.result; //the result of opening the db// 	tx = db.transaction("NameOfStore", "readwrite");// 	store = tx.objectStore("NameOfStore");// 	index = store.index("birthday");// 	// 	db.onerror = function(e) {// 		alert("ERROR "+ e.target.errorCode);// 	}// 	//  	store.put({qID: 1, birthday: "970727", name:"Paulina"});//  	store.put({qID: 2, birthday: "710125", name:"Yvonne"});// 	// 	let p1 = store.get(1);// 	let p2 = index.get("710125");// 	// 	p1.onsuccess = function() {// 		document.getElementById("p").textContent = p1.result.name;// 	}// 	// 	p2.onsuccess = function() {// 		document.getElementById("p").textContent += p2.result.name;// 	}// // 	tx.oncomplete = function() {// 		db.close();// 	}// }